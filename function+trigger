CREATE OR REPLACE FUNCTION uj_kolcsonzes()
RETURNS TRIGGER AS $$
BEGIN
    
    INSERT INTO SZAMLA (ugyfel)
    VALUES (NEW.ugyfel);
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_uj_kolcsonzes
AFTER INSERT ON KOLCSONZES
FOR EACH ROW
EXECUTE FUNCTION uj_kolcsonzes();


-------------------------

CREATE OR REPLACE FUNCTION uj_szamla()
RETURNS TRIGGER AS $$
BEGIN

    UPDATE KOLCSONZES
    SET szamla = NEW.id
    WHERE ugyfel = NEW.ugyfel AND szamla IS NULL;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_uj_szamla
AFTER INSERT ON SZAMLA
FOR EACH ROW
EXECUTE FUNCTION uj_szamla();
